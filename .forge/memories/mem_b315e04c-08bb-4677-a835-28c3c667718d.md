---
id: mem_b315e04c-08bb-4677-a835-28c3c667718d
created_at: 2026-02-26T06:23:00.709721Z
updated_at: 2026-02-26T06:23:00.709721Z
version: 1
scope: repo
category: architectural-decisions
related:
    - id: mem_b5cd0f66-cfb6-4b15-a94e-afc4d8f245da
      relationship: refines
    - id: mem_07f4f7be-1e4d-48b6-909a-e5a29ff7f412
      relationship: refines
    - id: mem_43530165-0fd3-4e42-b525-1bf061456088
      relationship: refines
session_id: 5e8b645a0da65b2d
trigger: compaction
---
The outlook-assistant source of truth is at `~/Agents/agent-tools/outlook-assistant/`. A new `mail/formatting.go` file was added implementing: `BodyFormat` type with `FormatText`/`FormatMarkdown`/`FormatHTML` constants, `ParseBodyFormat`, `RenderBody`, `RenderBodyInner`, and `ExtractBodyContent` functions. A `--format` flag was added to `main.go`. `Send`, `Reply`, and `Forward` functions in `mail/mail.go` were updated to accept and thread a `BodyFormat` parameter. The old `toHTMLBody`/`textToHTML` helpers in `mail/mail.go` were removed and replaced by `RenderBody` from `formatting.go`.